# ts-workflow

## Overview

This repo contains a TypeScript Lyra SDK allowing you to build Lyra workflows in TypeScript.  For more information see [https://github.com/lyraproj/lyra]()

Some sample TypeScript workflows can be found in the [examples](lib/examples) folder, and more in the [lyra repo](https://github.com/lyraproj/lyra/tree/master/examples/ts-samples/src).

Many of these workflows rely on types and state handlers (contained in "typesets") implemented in other languages and made available in typescript (and javascript) via the "[lyra](https://github.com/lyraproj/lyra) generate" CLI command (`lyra generate typescript`)

We will soon create an example state handler in TypeScript.

## Contents

[lib/examples]() - example workflows in typescript, used here for testing only.  See [the test folder](test) for usage.  The [lib/examples/vpc_with_subnet.ts]() is an example workflow which uses the [lib/examples/Aws.ts]() typeset which was, as mentioned above, generated by `lyra generate typescript`

[lib/datapb]() - this is the TypeScript implementation of the [data-protobuf](https://github.com/lyraproj/data-protobuf) data format, allowing transport of generic, deeply-nested data structures.

[lib/pcore]() - this is the TypeScript implementation of the [pcore](https://github.com/lyraproj/pcore) Puppet Type System.  This facilitates language-agnostic interoperability with an entirely native experience, in this case for TypeScript.

[lib/servicesdk]() - this is the only library that workflow writers need to interface with.  For example:

```TypeScript

const wf = {
  source: __filename,
  // define workflow here, see examples for how to do this
}
const sb = new ServiceBuilder('My::Service');
sb.workflow(wf);
const server = sb.build(global);
console.log(server.metadata());
```

## Testing

To test changes, run:

```sh
npm test
```

Or

```sh

./node_modules/pre-commit/hook
```

## Deploying 

The package is published here [https://www.npmjs.com/package/lyra-workflow]() and requires an npmjs login and access to be granted by the project team.

* Edit the version in package.json
* Run `npm login`
* Run `npm publish`
* Update [the package dependency in the lyra repo](https://github.com/lyraproj/lyra/blob/a76740105e0ab65c40ead015e9cd8acf2c666e29/examples/ts-samples/package.json#L28) to the new version.